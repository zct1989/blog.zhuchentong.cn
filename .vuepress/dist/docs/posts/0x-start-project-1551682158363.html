<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>0x-start-project源码学习 - 1 | 紫菜苔de前端小馆</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.87941fce.css" as="style"><link rel="preload" href="/assets/js/app.7e25505e.js" as="script"><link rel="preload" href="/assets/js/3.4c456c83.js" as="script"><link rel="preload" href="/assets/js/58.38a6ec3d.js" as="script"><link rel="prefetch" href="/assets/js/1.7f9baa1d.js"><link rel="prefetch" href="/assets/js/10.b3078e71.js"><link rel="prefetch" href="/assets/js/100.d8ae016d.js"><link rel="prefetch" href="/assets/js/101.f6577f56.js"><link rel="prefetch" href="/assets/js/102.24046e40.js"><link rel="prefetch" href="/assets/js/103.d5b9915f.js"><link rel="prefetch" href="/assets/js/104.6d9317fc.js"><link rel="prefetch" href="/assets/js/105.1c735d52.js"><link rel="prefetch" href="/assets/js/106.553f3416.js"><link rel="prefetch" href="/assets/js/107.2ff9089f.js"><link rel="prefetch" href="/assets/js/108.72334a91.js"><link rel="prefetch" href="/assets/js/109.ab5b89d9.js"><link rel="prefetch" href="/assets/js/11.48b38e03.js"><link rel="prefetch" href="/assets/js/110.c00c4692.js"><link rel="prefetch" href="/assets/js/111.054f232b.js"><link rel="prefetch" href="/assets/js/112.348fdc76.js"><link rel="prefetch" href="/assets/js/113.2666954c.js"><link rel="prefetch" href="/assets/js/114.8401f8aa.js"><link rel="prefetch" href="/assets/js/115.7a7040eb.js"><link rel="prefetch" href="/assets/js/116.4c68494b.js"><link rel="prefetch" href="/assets/js/117.628714f4.js"><link rel="prefetch" href="/assets/js/118.2a187c2e.js"><link rel="prefetch" href="/assets/js/119.35c2bc90.js"><link rel="prefetch" href="/assets/js/12.443612ee.js"><link rel="prefetch" href="/assets/js/120.d049d227.js"><link rel="prefetch" href="/assets/js/121.48041260.js"><link rel="prefetch" href="/assets/js/122.8be84181.js"><link rel="prefetch" href="/assets/js/123.bf0e653c.js"><link rel="prefetch" href="/assets/js/124.44ed450f.js"><link rel="prefetch" href="/assets/js/125.09870bea.js"><link rel="prefetch" href="/assets/js/126.42a4886a.js"><link rel="prefetch" href="/assets/js/127.af7ff8a1.js"><link rel="prefetch" href="/assets/js/128.7291d4f2.js"><link rel="prefetch" href="/assets/js/129.c49e42e3.js"><link rel="prefetch" href="/assets/js/13.dadac269.js"><link rel="prefetch" href="/assets/js/130.e1ee2b4b.js"><link rel="prefetch" href="/assets/js/131.27c50567.js"><link rel="prefetch" href="/assets/js/132.79c2b4e0.js"><link rel="prefetch" href="/assets/js/133.df0574a4.js"><link rel="prefetch" href="/assets/js/134.f38f6bca.js"><link rel="prefetch" href="/assets/js/14.e80ad288.js"><link rel="prefetch" href="/assets/js/15.0f63582e.js"><link rel="prefetch" href="/assets/js/16.0b17d178.js"><link rel="prefetch" href="/assets/js/17.e0125a2a.js"><link rel="prefetch" href="/assets/js/18.8a42eed8.js"><link rel="prefetch" href="/assets/js/19.15a10742.js"><link rel="prefetch" href="/assets/js/20.b7b1d0f5.js"><link rel="prefetch" href="/assets/js/21.40791261.js"><link rel="prefetch" href="/assets/js/22.f2c95780.js"><link rel="prefetch" href="/assets/js/23.ac518c9f.js"><link rel="prefetch" href="/assets/js/24.1dae90a3.js"><link rel="prefetch" href="/assets/js/25.efc09146.js"><link rel="prefetch" href="/assets/js/26.ab86d874.js"><link rel="prefetch" href="/assets/js/27.e5f565e9.js"><link rel="prefetch" href="/assets/js/28.0469e9c4.js"><link rel="prefetch" href="/assets/js/29.a8de8547.js"><link rel="prefetch" href="/assets/js/30.c0475b4a.js"><link rel="prefetch" href="/assets/js/31.b5eb0553.js"><link rel="prefetch" href="/assets/js/32.9c19ae0e.js"><link rel="prefetch" href="/assets/js/33.b1ed7508.js"><link rel="prefetch" href="/assets/js/34.1e16e05c.js"><link rel="prefetch" href="/assets/js/35.293091db.js"><link rel="prefetch" href="/assets/js/36.252b615a.js"><link rel="prefetch" href="/assets/js/37.1cd8996a.js"><link rel="prefetch" href="/assets/js/38.167a82a3.js"><link rel="prefetch" href="/assets/js/39.33db9824.js"><link rel="prefetch" href="/assets/js/4.54882aa9.js"><link rel="prefetch" href="/assets/js/40.450d32a0.js"><link rel="prefetch" href="/assets/js/41.9287a314.js"><link rel="prefetch" href="/assets/js/42.141e28e4.js"><link rel="prefetch" href="/assets/js/43.8a75dd80.js"><link rel="prefetch" href="/assets/js/44.3ee27bf5.js"><link rel="prefetch" href="/assets/js/45.4a481968.js"><link rel="prefetch" href="/assets/js/46.856423a7.js"><link rel="prefetch" href="/assets/js/47.f5eecad5.js"><link rel="prefetch" href="/assets/js/48.bf2e2c37.js"><link rel="prefetch" href="/assets/js/49.9de65ad2.js"><link rel="prefetch" href="/assets/js/5.394b0d79.js"><link rel="prefetch" href="/assets/js/50.5717ea36.js"><link rel="prefetch" href="/assets/js/51.559ab86e.js"><link rel="prefetch" href="/assets/js/52.fa636028.js"><link rel="prefetch" href="/assets/js/53.855c5365.js"><link rel="prefetch" href="/assets/js/54.479224a9.js"><link rel="prefetch" href="/assets/js/55.82303205.js"><link rel="prefetch" href="/assets/js/56.06703298.js"><link rel="prefetch" href="/assets/js/57.834a7c69.js"><link rel="prefetch" href="/assets/js/59.d9b4b32f.js"><link rel="prefetch" href="/assets/js/6.c3665a69.js"><link rel="prefetch" href="/assets/js/60.f93eef75.js"><link rel="prefetch" href="/assets/js/61.fc7d627b.js"><link rel="prefetch" href="/assets/js/62.37562b69.js"><link rel="prefetch" href="/assets/js/63.71270651.js"><link rel="prefetch" href="/assets/js/64.13e7ae2c.js"><link rel="prefetch" href="/assets/js/65.1251d365.js"><link rel="prefetch" href="/assets/js/66.31ee93bf.js"><link rel="prefetch" href="/assets/js/67.66ee58aa.js"><link rel="prefetch" href="/assets/js/68.c00ea48a.js"><link rel="prefetch" href="/assets/js/69.06818970.js"><link rel="prefetch" href="/assets/js/7.6efe852a.js"><link rel="prefetch" href="/assets/js/70.c3da057f.js"><link rel="prefetch" href="/assets/js/71.4a192e57.js"><link rel="prefetch" href="/assets/js/72.66c8fbc5.js"><link rel="prefetch" href="/assets/js/73.faf61deb.js"><link rel="prefetch" href="/assets/js/74.e3a9223e.js"><link rel="prefetch" href="/assets/js/75.b72d7462.js"><link rel="prefetch" href="/assets/js/76.2cdf4ef4.js"><link rel="prefetch" href="/assets/js/77.8cd6514e.js"><link rel="prefetch" href="/assets/js/78.7ca132ea.js"><link rel="prefetch" href="/assets/js/79.41e2ac49.js"><link rel="prefetch" href="/assets/js/8.53b5f5e2.js"><link rel="prefetch" href="/assets/js/80.13b4e376.js"><link rel="prefetch" href="/assets/js/81.dd6a6ef0.js"><link rel="prefetch" href="/assets/js/82.09201718.js"><link rel="prefetch" href="/assets/js/83.4605bf24.js"><link rel="prefetch" href="/assets/js/84.44fd975f.js"><link rel="prefetch" href="/assets/js/85.e5dc6b5f.js"><link rel="prefetch" href="/assets/js/86.0e2bc0cc.js"><link rel="prefetch" href="/assets/js/87.6373beea.js"><link rel="prefetch" href="/assets/js/88.43f718d2.js"><link rel="prefetch" href="/assets/js/89.59462d75.js"><link rel="prefetch" href="/assets/js/9.72eda18e.js"><link rel="prefetch" href="/assets/js/90.8136b873.js"><link rel="prefetch" href="/assets/js/91.3216e3ce.js"><link rel="prefetch" href="/assets/js/92.94ec4c29.js"><link rel="prefetch" href="/assets/js/93.712e48a3.js"><link rel="prefetch" href="/assets/js/94.a674e097.js"><link rel="prefetch" href="/assets/js/95.e365ad29.js"><link rel="prefetch" href="/assets/js/96.eb2961b1.js"><link rel="prefetch" href="/assets/js/97.cf9e240e.js"><link rel="prefetch" href="/assets/js/98.37ffbc3f.js"><link rel="prefetch" href="/assets/js/99.ad9f19e6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87941fce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container flex-row"><div class="sider-container"><div class="slider flex-column justify-content-center align-items-center"><div class="avatar"><img src="/avatar.jpg"></div> <div class="title">
        紫菜苔de前端小馆
    </div></div></div> <div class="post-container flex-auto" data-v-5185f74d><div class="title-container" data-v-5185f74d><div class="title" data-v-5185f74d>0x-start-project源码学习 - 1</div> <div class="date" data-v-5185f74d>2019年03月05日 00:03</div></div> <div class="content-container" data-v-5185f74d><div class="content__default" data-v-5185f74d><p>0x project在之前已经提过，它是一个去中心交易合约，它的作用是可以让ERC20或ERC721代币在链上进行交易，例如用户A希望用100TokenA换取50个TokenB,可以创建一个订单来实现这个交易，这个订单会在线上自动交易，这样不用担心用户之间交易的信用问题(如A把Token打给了B,但是B没有打给A对应的TOKEN)。</p> <p>0x项目的特点是向比与中心化交易所，去中心化交易更加可靠，和其他去中心化交易所相比，在进行交易之前0x的订单是在链下保存，他保障了交易的效率。</p> <p>更准确的说0x不仅是一个去中心化的交易的合约，而是一个去中心化交易的项目，他包括了一组合约来完成这个交易:</p> <h5 id="mainnet"><a href="#mainnet" class="header-anchor">#</a> Mainnet</h5> <hr> <ul><li>AssetProxyOwner: <a href="https://etherscan.io/address/0x17992e4ffb22730138e4b62aaa6367fa9d3699a6" target="_blank" rel="noopener noreferrer">0x17992e4ffb22730138e4b62aaa6367fa9d3699a6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ERC20Proxy: <a href="https://etherscan.io/address/0x2240dab907db71e64d3e0dba4800c83b5c502d4e" target="_blank" rel="noopener noreferrer">0x2240dab907db71e64d3e0dba4800c83b5c502d4e<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ERC721Proxy: <a href="https://etherscan.io/address/0x208e41fb445f1bb1b6780d58356e81405f3e6127" target="_blank" rel="noopener noreferrer">0x208e41fb445f1bb1b6780d58356e81405f3e6127<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Exchange: <a href="https://etherscan.io/address/0x4f833a24e1f95d70f028921e27040ca56e09ab0b" target="_blank" rel="noopener noreferrer">0x4f833a24e1f95d70f028921e27040ca56e09ab0b<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Forwarder: <a href="https://etherscan.io/address/0x5468a1dc173652ee28d249c271fa9933144746b1" target="_blank" rel="noopener noreferrer">0x5468a1dc173652ee28d249c271fa9933144746b1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>OrderValidator: <a href="https://etherscan.io/address/0x9463e518dea6810309563c81d5266c1b1d149138" target="_blank" rel="noopener noreferrer">0x9463e518dea6810309563c81d5266c1b1d149138<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>WETH9 (EtherToken): <a href="https://etherscan.io/address/0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2" target="_blank" rel="noopener noreferrer">0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ZRXToken: <a href="https://etherscan.io/address/0xe41d2489571d322189246dafa5ebde1f4699f498" target="_blank" rel="noopener noreferrer">0xe41d2489571d322189246dafa5ebde1f4699f498<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>本节主要是在看0x-start-project项目之前，我们先来了解一些相关的内容。</p> <h4 id="weth"><a href="#weth" class="header-anchor">#</a> WETH</h4> <hr> <p>WETH其实就是wrapped eth,意思是指被包裹的ETH,他与ETH1:1进行兑换，主要是因为ETH并不是ERC20代币,不符合0x的交易标准，所以可以通过WETH来代替ETH进行交易.</p> <h4 id="relayer"><a href="#relayer" class="header-anchor">#</a> Relayer</h4> <hr> <p>(Relayer)中继者是0x线下管理订单的实体，他可以通过撮合交易来获取中间费用，中继者的存在可以让订单在成交之前储存在线下，这样可以提供在线交易的效率,不同中继者之间可以流转交易订单，通过把订单提交给中继者然后让中继者广播也可以增加订单的传播途径。</p> <h4 id="sra"><a href="#sra" class="header-anchor">#</a> SRA</h4> <hr> <p>sra是指standard relayer api,通过standard relayer api可以快速构建一个relayer。</p> <h4 id="交易策略"><a href="#交易策略" class="header-anchor">#</a> 交易策略</h4> <hr> <ul><li>Open orderbook(开放订单策略)</li></ul> <p>订单设置Taker为空地址(0x0000000000000000000000000000000000000000),将订单提交给Relayer,当taker看到订单后,可以Fill Order然后提交订单信息,执行交易。
例如:用户A想用1 WETH换取1000 ZRX,用户A将订单OrderA提交给Relayer,用户B看到后通过<code>fillOrder(orderA, 1000)</code>完成交易获得1个WETH，这个交易由用户B执行，负责提供Gas。</p> <ul><li>Matching(匹配策略)</li></ul> <p>匹配策略是指由Relayer匹配用户的订单执行交易。
例如:用户A想用1WETH换取1000ZRX,将订单A提交给Relayer,用户B想用1000ZRX换取1WETH,将订单B提交给Relayer,Relayer发现订单A和订单B刚好可以匹配，通过<code>batchFillOrKillOrders(orderA, 1000, orderB, 1)</code>执行交易</p> <ul><li>Quote provider(报价策略/买入策略)</li></ul> <p>报价策略是指由Relayer提供一个报价，用户可以按照Relayer提供的报价创建订单，将Taker设置为Relayer，将订单提供给Relayer由其完成交易。
例如:Relayer提供每个WETH换取1000ZRX的报价，用户A提交提供10000ZRX换取10WETH的订单A，Relayer通过<code>fillOrder(orderA, 10000)</code>来执行交易。</p> <ul><li>Reserve manager (储备策略/卖出策略)</li></ul> <p>储备策略是指Relayer卖出指定的token,可以多个用户向Relayer进行交易。
例如:Relayer广播订单A,希望出售100WETH来换取100000ZRX在60秒内。用户A可以通过<code>fillOrder(orderA, 1000)</code>来换取2WETH,用户B可以通过<code>fillOrder(orderB, 2000)</code>来换取2WETH。</p> <h4 id="订单-order"><a href="#订单-order" class="header-anchor">#</a> 订单(Order)</h4> <hr> <p>订单是0x交易的基础数据类型，具体构成如下:</p> <div class="language- extra-class"><pre class="language-text"><code>interface Order {
	// 交易发送方地址 发送给0x
    senderAddress: string;
    // 卖方地址
    makerAddress: string;
    // 卖方地址
    takerAddress: string;
    // 卖方手续费
    makerFee: BigNumber;
    // 买房手续费
    takerFee: BigNumber;
    // 卖方币种金额
    makerAssetAmount: BigNumber;
    // 买方币种金额
    takerAssetAmount: BigNumber;
    // 卖方币种数据
    makerAssetData: string;
    // 买方币种数据
    takerAssetData: string;
    // 订单随机种子盐
    salt: BigNumber;
    // 交易地址(0x合约地址)
    exchangeAddress: string;
    // 手续费接收地址
    feeRecipientAddress: string;
    // 订单过期时间
    expirationTimeSeconds: BigNumber;
}
</code></pre></div><h4 id="zrx"><a href="#zrx" class="header-anchor">#</a> ZRX</h4> <hr> <p>ZRX是0x发行的代币，作为Relayer的中间交易费用,同时也可以用于0x项目的投票份额。</p> <h4 id="forwarder"><a href="#forwarder" class="header-anchor">#</a> Forwarder</h4> <hr> <p>Forwarder是促进者，运送者的意思，这里是指可以通过Forwarder实现ETH直接换取其他代币的操作，原本ETH不是ERC20代币，需要通过WETH进行交易，Forwarder可以直接自动换取WETH，实现了直接通过ETH换取其他代币，提升了用户体验。</p></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7e25505e.js" defer></script><script src="/assets/js/3.4c456c83.js" defer></script><script src="/assets/js/58.38a6ec3d.js" defer></script>
  </body>
</html>
