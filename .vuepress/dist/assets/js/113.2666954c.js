(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{430:function(a,t,s){"use strict";s.r(t);var e=s(39),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"rainbond搭建流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rainbond搭建流程"}},[a._v("#")]),a._v(" Rainbond搭建流程")]),a._v(" "),s("ol",[s("li",[a._v("修改主机NAT配置,为无外网主机添加外网访问支持")])]),a._v(" "),s("hr"),a._v(" "),s("h4",{attrs:{id:"添加路由表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加路由表"}},[a._v("#")]),a._v(" 添加路由表")]),a._v(" "),s("p",[a._v("进入 "),s("strong",[a._v("专用网络VPC->路由表->自定义")])]),a._v(" "),s("p",[a._v("添加目标网段为"),s("strong",[a._v("0.0.0.0/32")]),a._v(" 跳转目标为具有外网的机器实例")]),a._v(" "),s("h4",{attrs:{id:"关闭firewalld服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭firewalld服务"}},[a._v("#")]),a._v(" 关闭firewalld服务")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("systemctl stop firewalld\nsystemctl mask firewalld\nsystemctl disable firewalld\n")])])]),s("h4",{attrs:{id:"安装iptables服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装iptables服务"}},[a._v("#")]),a._v(" 安装iptables服务")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("yum install -y iptables iptables-services\n\nsystemctl enable iptables\nsystemctl start iptables\n")])])]),s("h4",{attrs:{id:"开启ecs的ip转发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启ecs的ip转发"}},[a._v("#")]),a._v(" 开启ECS的IP转发")]),a._v(" "),s("p",[a._v("修改/etc/sysctl.conf中的net.ipv4.ip_forward = 1")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("vi /etc/sysctl.conf\n\n# net.ipv4.ip_forward = 1 \n\n# 使配置生效\nsysctl -p\n")])])]),s("h4",{attrs:{id:"设置nat转发规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置nat转发规则"}},[a._v("#")]),a._v(" 设置NAT转发规则")]),a._v(" "),s("p",[a._v("将网段的请求转发到具有公网的机器上")]),a._v(" "),s("p",[a._v("192.168.0.0/16: VPC网段\n192.168.0.10   : 公网机器地址")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("iptables -t nat -I POSTROUTING -s 192.168.0.0/16 -j SNAT --to-source 192.168.0.10\n# 使配置生效\nservice iptables save\n# 重启iptables\nsystemctl restart iptables.service\n")])])]),s("p",[a._v("如果不能联网,请查看"),s("code",[a._v("/etc/sysconfig/iptables")]),a._v("文件,并且删除文件中的禁止转发选项")]),a._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[a._v("更新CentOS内核")])]),a._v(" "),s("hr"),a._v(" "),s("p",[a._v("首先需要将所有主机的CentOS内核进行更新")]),a._v(" "),s("h4",{attrs:{id:"更新内核"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新内核"}},[a._v("#")]),a._v(" 更新内核")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm\n\nyum --disablerepo="*" --enablerepo="elrepo-kernel" list available\n')])])]),s("h4",{attrs:{id:"安装内核"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装内核"}},[a._v("#")]),a._v(" 安装内核")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("yum --enablerepo=elrepo-kernel install kernel-ml -y\n")])])]),s("h4",{attrs:{id:"设置默认启动项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置默认启动项"}},[a._v("#")]),a._v(" 设置默认启动项")]),a._v(" "),s("p",[a._v("修改grub,设置"),s("strong",[a._v("GRUB_DEFAULT=0")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("vim /etc/default/grub\n")])])]),s("h4",{attrs:{id:"重新生成grub配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重新生成grub配置文件"}},[a._v("#")]),a._v(" 重新生成grub配置文件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("grub2-mkconfig -o /boot/grub2/grub.cfg\n")])])]),s("h4",{attrs:{id:"重启即可"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重启即可"}},[a._v("#")]),a._v(" 重启即可")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("reboot\n")])])]),s("h2",{attrs:{id:"_3-安装rainbond"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装rainbond"}},[a._v("#")]),a._v(" 3.安装Rainbond")]),a._v(" "),s("h4",{attrs:{id:"配置免密钥登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置免密钥登录"}},[a._v("#")]),a._v(" 配置免密钥登录")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ssh-keygen -t rsa -b 2048 -N '' -f ~/.ssh/id_rsa\nssh-copy-id $IP\n")])])]),s("h4",{attrs:{id:"下载安装包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载安装包"}},[a._v("#")]),a._v(" 下载安装包")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("wget https://rainbond-pkg.oss-cn-shanghai.aliyuncs.com/offline/5.2/easzup && chmod +x easzup && ./easzup -D\n")])])]),s("h4",{attrs:{id:"开始安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开始安装"}},[a._v("#")]),a._v(" 开始安装")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# 设置公网IP\nexport EIP=公网IP\n\n# 使用默认配置安装Rainbond集群\n./easzup -S && docker exec -it kubeasz easzctl start-aio\n")])])]),s("p",[a._v("安装完成后会打印如下提示")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[INFO] save context: aio\n[INFO] save aio roles' configration\n[INFO] save aio ansible hosts\n[INFO] save aio kubeconfig\n[INFO] save aio kube-proxy.kubeconfig\n[INFO] save aio certs\n[INFO] Action successed : start-aio\n[INFO] Visit http://$IP:30008 to view the installation progress\n")])])]),s("p",[a._v("之后访问对应主机的30008端口,通过UI进行安装即可.")])])}),[],!1,null,null,null);t.default=r.exports}}]);