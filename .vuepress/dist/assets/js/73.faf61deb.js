(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{390:function(a,e,n){"use strict";n.r(e);var t=n(39),l=Object(t.a)({},(function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("p",[a._v("最近angular更新了5版本，随之@angular/cli发布了1.5版本，最近有同事发现了原angular4的项目无法打包，结果发现执行npm run build后会出现这样的错误:")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("ERROR in Error: Metadata version mismatch for module xxx found version 4, expected 3\n")])])]),n("p",[a._v("主要原因是因为angular不同包之间版本不匹配造成，这就涉及到了package.json里面包版本号匹配的问题。")]),a._v(" "),n("p",[a._v("那就再来看看package.json包版本管理的一些概念。")]),a._v(" "),n("p",[a._v("package.json文件中一个版本号包括三个部分： [主要版本号，次要版本号，补丁版本号]")]),a._v(" "),n("ol",[n("li",[a._v("用 ~ 指示范围")])]),a._v(" "),n("p",[n("code",[a._v("~")]),a._v(" 表示允许补丁版本升级，如果没有指定次要版本是，那么也允许次要版本升级，如：")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("~1.2.3 >= 1.2.3 < 1.3.0\n~1.2 >= 1.2.0 < 1.3.0\n~1 >= 1.0.0 < 2.0.0\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[a._v("用 ^ 指示范围")])]),a._v(" "),n("p",[n("code",[a._v("^")]),a._v(" 表示允许最左侧不为零的版本号右侧的版本号升级，如:")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("^1.2.3 >=1.2.3 < 2.0.0\n^0.2.3 >=0.2.3 < 0.3.0\n^0.0.3 >=0.0.3 < 0.0.4\n")])])]),n("p",[a._v("那么明白了这个再来看看，angular之前无法打包的问题，其实主要问题是在@angular/cli和@angular/xxx其他模块的版本都使用了"),n("code",[a._v("^")]),a._v("指定范围，所以"),n("code",[a._v("^1.4.3")]),a._v("会升级为"),n("code",[a._v("1.5.0")]),a._v("版本，但是其他的angular模块如@angular/core的"),n("code",[a._v("4.3.3")]),a._v("的版本号会停留在"),n("code",[a._v("4.x.x.")]),a._v("版本不会一起升至"),n("code",[a._v("5.0.0")]),a._v("，这样在重新"),n("code",[a._v("npm install")]),a._v("的时候就下载的不匹配版本的包，造成了上面的问题。")]),a._v(" "),n("p",[a._v("简单的修改办法就是不使用范围符指定版本, 直接写上固定的版本号，这样每次回下载相同的版本号,避免问题的发生,或者使用"),n("code",[a._v("npm-check")]),a._v("进行手动从angular4升级至angular5,这种跨大版本的升级还是应该小心避免的。")])])}),[],!1,null,null,null);e.default=l.exports}}]);